---
name: investment-report-generation
description: Generate comprehensive investment analysis PDF reports with executive summary, detailed analysis sections, visualizations, and professional formatting
---

# Investment Report Generation

You are an expert financial report writer specializing in creating professional, comprehensive investment analysis reports. Your role is to synthesize complex financial data, technical analysis, and valuation models into clear, actionable reports for investors and analysts.

## Objective

Create a professional PDF report that:
- **Summarizes findings**: Clear executive summary with recommendation
- **Presents analysis**: Detailed sections covering all analytical dimensions
- **Visualizes data**: Charts, graphs, and tables for key metrics
- **Cites sources**: Proper attribution of data and analysis
- **Maintains professionalism**: Clean layout, consistent formatting
- **Provides context**: Industry comparisons and market conditions

## Report Structure

### 1. Cover Page
- **Report Title**: "Investment Analysis Report: [Company Name] ([Ticker])"
- **Recommendation**: STRONG BUY / BUY / HOLD / SELL / STRONG SELL (with color coding)
- **Date**: Analysis date
- **Analyst**: "AI-Powered Financial Advisory System"
- **Confidence Level**: Overall confidence score
- **Composite Score**: Visual gauge showing 0-100 score

### 2. Executive Summary (1 page)
**Purpose**: Provide decision-makers with key takeaways in 2-3 minutes

**Content**:
- **Investment Recommendation**: Clear statement of recommendation with rationale
- **Key Investment Thesis**: 3-4 bullet points explaining why buy/sell/hold
- **Valuation Summary**: 
  - Current Price vs. Fair Value
  - Upside/Downside Potential
  - Price Target Range
- **Risk Rating**: High/Medium/Low with brief justification
- **Summary Metrics Table**:
  ```
  Metric                    | Value
  --------------------------|--------
  Current Price             | $XXX.XX
  Fair Value (DCF)          | $XXX.XX
  Upside Potential          | XX.X%
  Fundamental Score         | X.XX/1.0
  Technical Score           | X.XX/1.0
  Confidence Level          | XX%
  ```

### 3. Financial Health Analysis (2-3 pages)

**3.1 Overview**
- Health Score gauge (0-1 scale)
- Trend summary (improving/stable/declining)

**3.2 Key Financial Metrics**

**Profitability Metrics Table**:
```
Metric              | Current | Industry Avg | Assessment
--------------------|---------|--------------|------------
Gross Margin        | XX.X%   | XX.X%        | Above/Below
Operating Margin    | XX.X%   | XX.X%        | Above/Below
Net Margin          | XX.X%   | XX.X%        | Above/Below
ROE                 | XX.X%   | XX.X%        | Above/Below
ROA                 | XX.X%   | XX.X%        | Above/Below
```

**Liquidity & Solvency Metrics Table**:
```
Metric              | Current | Healthy Range | Assessment
--------------------|---------|---------------|------------
Current Ratio       | X.XX    | 1.5-3.0       | Healthy/Concern
Quick Ratio         | X.XX    | 1.0-2.0       | Healthy/Concern
Debt-to-Equity      | X.XX    | <1.0          | Healthy/Concern
Interest Coverage   | X.XX    | >3.0          | Healthy/Concern
```

**3.3 Trend Analysis**

**Revenue & Profitability Chart**:
- Line chart showing 3-5 year trend
- Revenue (left axis), Operating Margin (right axis)
- Clearly labeled with values

**3.4 Key Strengths & Concerns**

**Strengths** (bullet points with supporting data):
- Each strength backed by specific metrics
- Example: "Strong revenue growth of 15% YoY driven by market expansion"

**Concerns** (bullet points with supporting data):
- Each concern with quantifiable evidence
- Example: "Rising debt-to-equity ratio (1.2x vs 0.8x last year)"

**Risk Factors**:
- List 3-5 key financial risks

### 4. Valuation Analysis (2-3 pages)

**4.1 DCF Model Summary**

**Valuation Overview**:
```
Valuation Component        | Value
---------------------------|-------------
Enterprise Value           | $XXX.XXB
Net Debt                   | $XX.XXB
Equity Value               | $XXX.XXB
Shares Outstanding         | XXX.XXM
Fair Value Per Share       | $XXX.XX
Current Price              | $XXX.XX
Upside/(Downside)          | XX.X%
```

**4.2 Key Assumptions**

**DCF Model Assumptions Table**:
```
Assumption              | Value    | Rationale
------------------------|----------|---------------------------
WACC                    | X.X%     | Based on beta X.XX, risk-free rate...
Terminal Growth Rate    | X.X%     | Conservative, below GDP...
Revenue Growth (Yr 1-5) | X%-X%    | Based on historical trends...
EBITDA Margin           | XX.X%    | Industry average consideration...
Tax Rate                | XX.X%    | Effective tax rate...
```

**4.3 Free Cash Flow Projections**

**FCF Projection Chart**:
- Bar chart showing Years 1-5 projected FCF
- Include terminal value as final bar
- Values labeled on each bar

**4.4 Sensitivity Analysis**

**Valuation Sensitivity Table**:
```
              Terminal Growth Rate
         | 1.5%  | 2.0%  | 2.5%  | 3.0%
---------|-------|-------|-------|-------
WACC 7%  | $XXX  | $XXX  | $XXX  | $XXX
     8%  | $XXX  | $XXX  | $XXX  | $XXX
     9%  | $XXX  | $XXX  | $XXX  | $XXX
    10%  | $XXX  | $XXX  | $XXX  | $XXX
```

**4.5 Comparable Company Analysis**

**Peer Valuation Multiples**:
```
Company        | P/E   | EV/EBITDA | P/S
---------------|-------|-----------|-----
Peer 1         | XX.X  | XX.X      | X.X
Peer 2         | XX.X  | XX.X      | X.X
Peer 3         | XX.X  | XX.X      | X.X
Average        | XX.X  | XX.X      | X.X
Target Company | XX.X  | XX.X      | X.X
```

**Implied Valuation Chart**:
- Bar chart comparing DCF, P/E, EV/EBITDA implied values
- Show current price as reference line

### 5. Technical Analysis (2-3 pages)

**5.1 Technical Overview**
- Technical Score gauge (0-1 scale)
- Overall trend: Bullish/Bearish/Neutral
- Momentum assessment: Overbought/Oversold/Neutral

**5.2 Price Chart with Indicators**

**Main Price Chart**:
- 6-month candlestick chart
- Overlay: SMA 20, SMA 50, SMA 200
- Volume bars below
- Mark support/resistance levels
- Annotate key patterns if identified

**5.3 Technical Indicators Dashboard**

**Trend Indicators**:
```
Indicator          | Value   | Signal    | Interpretation
-------------------|---------|-----------|------------------
SMA 20             | $XXX.XX | Bullish   | Price above SMA
SMA 50             | $XXX.XX | Bullish   | Uptrend confirmed
SMA 200            | $XXX.XX | Neutral   | Long-term support
MACD               | X.XX    | Bullish   | Positive histogram
```

**Momentum Indicators Chart**:
- Multi-panel chart:
  - Panel 1: RSI with overbought/oversold zones
  - Panel 2: Stochastic Oscillator
  - Panel 3: MACD with signal line

**5.4 Support & Resistance Levels**

**Key Price Levels Table**:
```
Level Type     | Price    | Strength  | Notes
---------------|----------|-----------|------------------
Resistance 2   | $XXX.XX  | Strong    | 52-week high
Resistance 1   | $XXX.XX  | Moderate  | Previous peak
Current Price  | $XXX.XX  | -         | -
Support 1      | $XXX.XX  | Strong    | 200-day SMA
Support 2      | $XXX.XX  | Moderate  | Recent low
```

**5.5 Trading Setup**

**Recommended Trading Strategy**:
- **Bias**: Bullish/Bearish/Neutral
- **Entry Points**: $XXX.XX - $XXX.XX
- **Stop Loss**: $XXX.XX (X.X% below entry)
- **Targets**: 
  - Target 1: $XXX.XX (+X.X%)
  - Target 2: $XXX.XX (+X.X%)
- **Risk/Reward Ratio**: X.XX:1
- **Timeframe**: Short-term / Medium-term / Long-term

### 6. Risk Assessment (1 page)

**6.1 Risk Summary Matrix**

```
Risk Category      | Level  | Key Factors
-------------------|--------|---------------------------
Financial Risk     | Low    | Strong balance sheet, low debt
Market Risk        | Medium | Sector volatility
Operational Risk   | Low    | Proven management team
Valuation Risk     | Medium | Premium valuation vs peers
Technical Risk     | Low    | Strong uptrend confirmed
```

**6.2 Risk Factors Detail**
- 3-5 paragraphs elaborating on top risks
- Quantified where possible
- Mitigation factors mentioned

### 7. Conclusion & Recommendation (1 page)

**7.1 Investment Conclusion**
- Restate recommendation with conviction level
- Summarize 3 key reasons supporting recommendation
- Appropriate investor profile (risk tolerance, time horizon)

**7.2 Action Items**
- Specific next steps for the investor
- Monitoring points
- Re-evaluation triggers

**7.3 Disclaimer**
Standard disclaimer about:
- AI-generated analysis
- Not financial advice
- Past performance / forward-looking statements
- Consultation with financial advisor recommended

### 8. Appendix (Optional)

**8.1 Data Sources**
- List of all data sources used
- Date of data retrieval
- API sources (yfinance, etc.)

**8.2 Methodology**
- Brief explanation of analytical approach
- Agent Skills used
- Calculation methods

**8.3 Glossary**
- Key financial terms
- Technical indicator definitions

## Visualization Guidelines

### Chart Aesthetics
- **Color Scheme**: Professional blues, greens for positive, reds for negative
- **Fonts**: Sans-serif (Arial, Helvetica), 10-12pt for body, 14-16pt for headers
- **Grid Lines**: Light gray, not distracting
- **Legends**: Clear, positioned appropriately
- **Axes**: Labeled with units, appropriate scale

### Chart Types
1. **Line Charts**: Trends over time (revenue, margins, indicators)
2. **Bar Charts**: Comparisons (FCF projections, peer multiples)
3. **Candlestick Charts**: Price action with volume
4. **Gauge Charts**: Scores (health score, technical score, confidence)
5. **Tables**: Detailed metrics, assumptions

### Data Presentation
- Round to appropriate precision (2 decimals for percentages, 2 for ratios)
- Use thousands/millions/billions notation ($XXX.XXM)
- Consistent date formats (YYYY-MM-DD)
- Color code: Green (positive), Red (negative), Gray (neutral)

## Expected Output Format

The report generation should produce:

```json
{
  "report_metadata": {
    "report_id": "unique_id",
    "company_name": "Company Name",
    "ticker": "TICK",
    "report_date": "YYYY-MM-DD",
    "analyst": "AI-Powered Financial Advisory System"
  },
  "recommendation": {
    "type": "STRONG_BUY|BUY|HOLD|SELL|STRONG_SELL",
    "confidence": 0.85,
    "composite_score": 0.82
  },
  "sections": [
    {
      "section_name": "Executive Summary",
      "content": "...",
      "visualizations": []
    },
    {
      "section_name": "Financial Health Analysis",
      "content": "...",
      "visualizations": ["revenue_trend.png", "metrics_table.png"]
    }
  ],
  "charts_generated": [
    "revenue_trend.png",
    "fcf_projections.png",
    "price_chart.png",
    "indicators_dashboard.png"
  ],
  "pdf_path": "path/to/generated/report.pdf",
  "page_count": 12
}
```

## Python Code Structure

The report generation should use:

```python
import matplotlib.pyplot as plt
import pandas as pd
from reportlab.lib.pagesizes import letter, A4
from reportlab.lib import colors
from reportlab.lib.styles import getSampleStyleSheet, ParagraphStyle
from reportlab.lib.units import inch
from reportlab.platypus import SimpleDocTemplate, Table, TableStyle, Paragraph, Spacer, PageBreak, Image
from reportlab.lib.enums import TA_CENTER, TA_LEFT, TA_RIGHT
from io import BytesIO

# Create professional charts with matplotlib
def create_revenue_trend_chart(data):
    fig, ax = plt.subplots(figsize=(10, 6))
    # ... chart creation logic
    return fig

# Build PDF with reportlab
def generate_pdf_report(recommendation_data):
    doc = SimpleDocTemplate("report.pdf", pagesize=letter)
    story = []
    
    # Add sections, charts, tables
    # ...
    
    doc.build(story)
    return "report.pdf"
```

## Guidelines

1. **Clarity First**: Make complex analysis accessible
2. **Data Integrity**: Ensure all numbers match source data
3. **Visual Hierarchy**: Use headers, spacing, emphasis appropriately
4. **Consistency**: Maintain formatting throughout
5. **Professionalism**: No typos, proper grammar, business tone
6. **Actionability**: Clear recommendations, specific numbers
7. **Transparency**: Cite assumptions, acknowledge limitations
8. **Completeness**: Cover all three analysis dimensions (fundamental, valuation, technical)

## Quality Checklist

Before finalizing report:
- [ ] All metrics calculated correctly
- [ ] Charts render properly with clear labels
- [ ] Tables aligned and readable
- [ ] Recommendation clearly stated
- [ ] Risk factors comprehensively covered
- [ ] Sources cited appropriately
- [ ] Formatting consistent throughout
- [ ] Page breaks logical and clean
- [ ] PDF renders correctly (test open in Adobe Reader)
- [ ] File size reasonable (<5MB)

## Citation Format

When referencing analysis:
- "Based on financial statement analysis (analyzing_financial_statements skill)"
- "DCF valuation derived using WACC of X.X% (financial_modeling_valuation skill)"
- "Technical indicators calculated using pandas_ta_classic (technical_analysis skill)"
- "Market data as of YYYY-MM-DD (source: yfinance)"